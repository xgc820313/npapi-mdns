<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Local Web Services</title>
	</head>
	<body>
		<h1>Local WEB Services</h1>
		<embed id="plugin" type="application/dbusmdns" width=0 height=0>
		<script>
			var plugin=document.getElementById("plugin");
			var httpServices={};
			
			setInterval(function(){
				var msg=plugin.popmsg();
				try {
					var jobj = eval("jobj="+msg);
				} catch(err) {
					var jobj = {};
				};
				jobj= jobj || {};
				var signalName = jobj.signal || null;
				if (null==signalName)
					return;

				var signal=signalName.toLowerCase();
				console.log("signal: "+signal);
				
				if (signal=="itemnew") {
					console.log("new services, name: "+jobj["name"]);
					httpServices[jobj["name"]]=jobj;
				}

				if (signal=="itemremove") {
					console.log("service removed, name: "+jobj["name"]);
					delete httpServices[jobj["name"]];
				}

				console.log( httpServices );
			},1*1000);
		
		</script>	
	</body>
</html>